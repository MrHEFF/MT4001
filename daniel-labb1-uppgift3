---
title: "Untitled"
author: "Daniel Svedlund"
date: "2024-11-18"
output:
  pdf_document: default
  html_document: default
---
\renewcommand{\figurename}{Figur} 
\renewcommand{\tablename}{Tabell}

# Uppgift 3: Explorativ dataanalys

Vi ska utforska csv-filen "olvinsprit.csv" som har 4 variabler "Land", "beer", "vin", och "sprit", där den genomsnittliga konsumtionen har mätts i 18 st OECD-länder.

```{r}
data <- read.csv("olvinsprit.csv", header = TRUE)

land <- data$Land
beer <- data$beer
vin <- data$vin
sprit <- data$sprit
```

Vi kan börja utforska om någon alkoholtyp kan anses vara normalfördelad och gör detta genom att skapa histogram för vardera alkoholtyp där vi även ritar in kurvan för en normalfördelning med väntevärde = medelvärdet av alkoholtypen samt standardavvikelse = standardavvikelsen för alkoholtypen.

```{r, fig.cap = "Data från öl, vin och sprit plottat som histogram och jämförd med den teoretiska normalfördelningen, representerad av linjen."}

old_par <- par(mfrow = c(1, 3)) # 1 rad, 3 kolonner

hist(beer, prob = TRUE, main = "Histogram Ölkonsumtion", 
     xlab = "Ölkonsumtion per land", ylab ="Densitet")
x <- seq(from = 20, to = 160, length.out = 100)
lines(x, dnorm(x, mean(beer), sd(beer)))

hist(vin, prob = TRUE, main = "Histogram Vinkonsumtion", 
     xlab = "Vinkonsumtion per land", ylab ="Densitet")
x <- seq(from = 0, to = 60, length.out = 100)
lines(x, dnorm(x, mean(vin), sd(vin)))

hist(sprit, prob = TRUE, main = "Histogram Spritkonsumtion", 
     xlab = "Spritkonsumtion per land", ylab ="Densitet")
x <- seq(from = 2, to = 9, length.out = 100)
lines(x, dnorm(x, mean(sprit), sd(sprit)))

par(old_par)
```

Från figur ser ölkonsumtionen ut att kunna vara normalfördelad medan vin och sprit mer liknar en exponentialfördelning.

```{r, fig.cap = "Normalfördelningsplottar som visar hur nära den totala konsumtionen för alla länder av antingen öl, vin eller sprit ligger en normalfördelning."}

old_par <- par(mfrow = c(1, 3)) # 1 rad, 3 kolonner

qqnorm(beer, main = "Ölkonsumtion", xlab = " ", ylab = " ")
qqline(beer)

qqnorm(vin, main = "Vinkonsumtion", xlab = " ", ylab = " ")
qqline(vin)

qqnorm(sprit, main = "Spritkonsumtion", xlab = " ", ylab = " ")
qqline(sprit)

par(old_par)
```

Från normalfördelningsplottarna i figur är det svårare att dra någon slutsats men spritkonsumtionen avviker något mer än de andra från räta linjen vilket även detta talar för att den ej är normalfördelad.

För att jämföra alkoholkonsumtionen av öl, vin och sprit mellan länderna kan vi jämföra detta i 3 stolpdiagram, ett för respektive alkoholtyp.

```{r, fig.cap = "Stopldiagram med genomsnittlig ölkonsumtion samt en horisontell linje som visar medelkonsumtionen för alla länder."}
 
barplot(beer, names.arg = land, xlab ="Länder",
        ylab ="Ölkonsumtion", col ="gold",
        main ="Genomsnittlig ölkonsumtion i 18 OECD-länder",
        cex.names=.29)

abline(mean(beer), 0)
```

```{r, fig.cap = "Stopldiagram med genomsnittlig vinkonsumtion samt en horisontell linje som visar medelkonsumtionen för alla länder."}
barplot(vin, names.arg = land, xlab ="Länder",
        ylab ="Vinkonsumtion", col ="red",
        main ="Genomsnittlig vinkonsumtion i 18 OECD-länder",
        cex.names=.29)

abline(mean(vin), 0)
```

```{r, fig.cap = "Stopldiagram med genomsnittlig spritkonsumtion samt en horisontell linje som visar medelkonsumtionen för alla länder."}
barplot(sprit, names.arg = land, xlab ="Länder",
        ylab ="Spritkonsumtion", col ="lightgrey",
        main ="Genomsnittlig spritkonsumtion i 18 OECD-länder",
        cex.names=.29)

abline(mean(sprit), 0)
```

Vi ser att Sverige verkligen inte avviker i någon av öl, vin- och spritkonsumtion. Vi är landet lagom. 

Från figur ser vi att Irland har överlägset högst ölkonsumtion medan figur visar att Italien har högst vinkonsumtion följt av Frankrike. I figur ser vi att högsta spritkonsumtionen sker i Japan, även där följt av Frankrike. Från stolpdiagrammen går det även att se att Tyskland är det enda landet som ligger över medel i samtliga alkoholtyper.

\newpage

Ett någorlunda gemensamt drag hos de extrema länderna i öl- och vinkonsumtion är att de tenderar att endast ligga högt i den ena av dessa. Detta kan klart ses i figur (första textplot) där de som ligger allra högst i antingen öl- eller vinkonsumtion ligger bland de lägsta i den andra. 

Bland övriga länder kan man istället se en ganska tydlig positiv korrelation där ökad ölkonsumtion medför ökad vinkonsumtion. Samband mellan öl-sprit samt vin-sprit är svårare att säga något om.

```{r}

plot(beer, vin, xlab = "Öl", ylab = "Vin")
text(beer, vin, land)

plot(beer, sprit, xlab = "Öl", ylab = "Sprit")
text(beer, sprit, land)

plot(sprit, vin, xlab = "Sprit", ylab = "Vin")
text(sprit, vin, land)
```

```{r}
total_alk_kons = beer + vin + sprit # Skapa en vektor med totala alkoholkonsumtionen.
```

Vi kan avsluta med att kolla på den totala alkoholkonsumtionen i länderna. Detta kan illustreras på ett smidigt sätt med ett stolpdiagram, figur . Här ser vi att Norge kniper förstaplatsen om man får uttrycka det så, tätt följt av Sverige och Japan. 

Om man dock tänker sig att de negativa effekterna av alkohol är starkt korrelerad med procenten, vilket nog ändå får sägas rimligt blir detta dock en missvisande bild. T.ex. Japan hade ju den högsta spritkonsumtionen av samtliga länder, där procenten kan antas vara högre än för öl och vin men eftersom att sprit konsumeras i mindre mängder än öl och vin så ger det inte lika stor effekt på totala konsumtionen.

Tycker ändå överlag att konsumtionen ligger ganska jämt fördelad över länderna, som tidigare nämndes är enbart Tyskland över medel för samtliga alkoholtyper men inte högst i någon av dem. Irland uppfyller stereotypen som öldrickarnation likaså Frankrike och Italien som vinkonsumerare. Spritkonsumtionen i Japan var något oväntad, men all in all ganska väntade resultat.

```{r, fig.cap = "Totala alkoholkonsumtionen i 18 OECD-länder."}

barplot(total_alk_kons, names.arg = land, xlab ="Länder",
        ylab ="Totala alkoholkonsumtionen", col ="black",
        main ="Totala alkoholkonsumtionen i 18 OECD-länder.",
        cex.names=.29)
```
